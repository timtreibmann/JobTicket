<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<h:head></h:head>

<h:body>
	<h:form id="mainform">
		<h:outputStylesheet library="css" name="style.css" />
		<p:tooltip for="find" value="Kunden mit Kundenkürzel suchen"></p:tooltip>
		<p:tooltip for="neuerKundeButton" value="Neuen Kunden anlegen"></p:tooltip>
		<p:growl id="growl"></p:growl>

		<p:panel style="width:70%">
			<p:breadCrumb styleClass="breadCrumbpanel">
				<p:menuitem value="Übersicht" url="start.xhtml" />
				<p:menuitem value="Jobticket" url="jobticket_main.xhtml" />
			</p:breadCrumb>

			<p:messages id="messages" />
			<p></p>
			<p:panelGrid styleClass="grid">


				<p:row>
					<p:column>
						<p:outputLabel for="jobnummer" value="Jobnummer" />
					</p:column>
					<p:column>
						<p:outputLabel
							value="#{jobticketBean.job.id==0 ? 'wird generiert' : jobticketBean.job.id}"
							id="jobnummer" />
					</p:column>
					<p:column>
						<p:outputLabel for="alt" value="Alte Jobnummer" />
					</p:column>
					<p:column>
						<p:inputText style="width:100%"
							value="#{jobticketBean.job.alteJobnummer}" id="alt">
							<p:ajax event="change" process="@this" update="growl"
								listener="#{jobticketBean.updateJobticket}"></p:ajax>
						</p:inputText>
					</p:column>
				</p:row>
				<p:row>
					<p:column>
						<p:outputLabel for="kundenname" value="Kundenname: " />
					</p:column>
					<p:column>
						<p:selectOneMenu style="width:103%" id="kundenname"
							value="#{jobticketBean.selectedKundeId}" editable="false"
							effect="fold">

							<f:selectItems value="#{kundenBean.kunden}" var="kunde"
								itemLabel="#{kunde.name}" itemValue="#{kunde.id}" />
							<p:ajax event="change" process="@this" update="@this growl"
								listener="#{jobticketBean.updateJobticket}"></p:ajax>

						</p:selectOneMenu>
					</p:column>
					<p:column>
						<p:outputLabel for="kundenkurz" value="Kundenkürzel" />
					</p:column>
					<p:column>
						<p:inputText style="width:100%" value="#{jobticketBean.kuerzel}"
							id="kundenkurz">
						</p:inputText>
					</p:column>
					<p:column>
						<h:panelGroup>
							<p:commandButton id="find" icon="ui-icon-search"
								update="kundenname"
								actionListener="#{jobticketBean.findKundeByKuerzel}"
								styleClass="findKundeByKuerzelButton" />


							<p:commandButton id="neuerKundeButton" icon="ui-icon-plus">

							</p:commandButton>
						</h:panelGroup>
					</p:column>
				</p:row>
				<p:row>
					<p:column>
						<p:outputLabel for="job" value="Jobname" />

					</p:column>
					<p:column>
						<p:inputText style="width:100%" id="job"
							value="#{jobticketBean.job.name}">
							<p:ajax event="change" process="@this" update="@this growl"
								listener="#{jobticketBean.updateJobticket}"></p:ajax>

						</p:inputText>
					</p:column>
					<p:column rowspan="3">
						<p:outputLabel for="jobbeschreibung" value="Beschreibung">


						</p:outputLabel>
					</p:column>
					<p:column rowspan="3">
						<p:inputTextarea style="width:100%" maxlength="200"
							value="#{jobticketBean.job.jobbeschreibung}" id="jobbeschreibung">
							<p:ajax event="change" process="@this" update="@this growl"
								listener="#{jobticketBean.updateJobticket}"></p:ajax>
						</p:inputTextarea>
					</p:column>
				</p:row>
				<p:row>
					<p:column>
						<p:outputLabel for="budget_in_eur" value="Budget in Euro" />
					</p:column>
					<p:column>
						<p:inputText style="width:100%"
							value="#{jobticketBean.job.budgetInEuro}" id="budget_in_eur">
							<p:ajax event="change" process="@this" update="@this growl"
								listener="#{jobticketBean.updateJobticket}"></p:ajax>
						</p:inputText>
					</p:column>
				</p:row>
				<p:row>
					<p:column>
						<p:outputLabel for="erstelldatum" value="Erstelldatum:" />
					</p:column>
					<p:column>
						<h:outputText id="erstelldatum"
							value="#{jobticketBean.job.erstellDatum}">
							<f:convertDateTime type="date" pattern="dd.MM.yyyy"></f:convertDateTime>
						</h:outputText>
					</p:column>
				</p:row>
				<p:row>
					<p:column>
						<p:outputLabel for="ersteller" value="Ersteller:" />
					</p:column>
					<p:column>
						<p:outputLabel id="ersteller"
							value="#{jobticketBean.job.ersteller==null  ? request.remoteUser : jobticketBean.job.ersteller}" />
					</p:column>
				</p:row>
				<p:row>
					<p:column colspan="7">

					</p:column>
				</p:row>

			</p:panelGrid>
			<p></p>
			<p:button outcome="start.xhtml" value="Zurück"
				styleClass="buttonZurueck" />

			<p:commandButton ajax="false"
				action="jobticket_produktbeschreibung.xhtml" value="Weiter">
			</p:commandButton>
		</p:panel>
	</h:form>

	<p:overlayPanel my="right top" widgetVar="overlay" showEffect="fade"
		hideEffect="explode" for=":mainform:neuerKundeButton">
		<h:form id="kundenform">
			<p:messages></p:messages>
			<p:growl id="growl"></p:growl>

			<h:panelGrid styleClass="grid" columns="2">
				<p:outputLabel for="t1">Kundenname</p:outputLabel>
				<p:inputText style="width:100%" id="t1"
					value="#{kundenBean.kunde.name}" autocomplete="true"
					required="true" />
				<p:outputLabel> Kundenkürzel</p:outputLabel>
				<p:inputText style="width:100%"
					value="#{kundenBean.kunde.kundenkuerzel}" autocomplete="
				true" />
				<p:outputLabel> Adresse</p:outputLabel>
				<p:inputText style="width:100%" id="t2"
					value="#{kundenBean.kunde.adresse}" autocomplete="true" />
				<p:outputLabel> Telefon</p:outputLabel>
				<p:inputText style="width:100%" id="t3"
					value="#{kundenBean.kunde.telefon}" autocomplete="true" />
			</h:panelGrid>
			<h:panelGrid columns="4">
				<p:commandButton immediate="true" onclick="overlay.hide()"
					value="Schließen" />
				<p:commandButton actionListener="#{kundenBean.saveKunde}"
					update="growl :mainform:kundenname" value="Kunden hinzufügen">
				</p:commandButton>
				<p></p>
				<p:button value="Kundenliste anzeigen"
					icon="ui-icon-arrowreturn-1-e" outcome="kunden_table.xhtml" />
			</h:panelGrid>

		</h:form>
	</p:overlayPanel>


</h:body>
</html>