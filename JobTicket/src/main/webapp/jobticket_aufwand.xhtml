<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:head></h:head>
<h:body>
	<h:form>
	<p:breadCrumb>
		<p:menuitem value="Übersicht"
			url="http://localhost:8080/JobTicket/faces/start.xhtml" />
		<p:menuitem value="Jobticket"
			url="http://localhost:8080/JobTicket/faces/jobticket_main.xhtml" />
		<p:menuitem value="Aufwand festlegen"
			url="http://localhost:8080/JobTicket/faces/jobticket_aufwand.xhtml" />
	</p:breadCrumb>
		<h:panelGrid columns="2">


			<p:panel id="panel" header="Aufwand für #{jobticketBean.job.name}">
				<p:messages id="messages" />
				<h:panelGrid columns="1">
					<h:panelGrid columns="2">

						<h:inputHidden value="#{aufwandBean.kosten.id}"></h:inputHidden>
						<h:inputHidden></h:inputHidden>

						<p:fieldset>
							<p:outputLabel for="kontakter" value="Angestellter" />

							<p:selectOneMenu id="kontakter"
								value="#{aufwandBean.selectedAngestellteId}" effect="fold"
								editable="false" required="true">
								<f:selectItems value="#{angestellteBean.angestelltes}"
									var="angestellte" itemLabel="#{angestellte.vorname}"
									itemValue="#{angestellte.id}" />
								<p:ajax event="change" update="@form"
									listener="#{aufwandBean.selectedAngestellteId}" />
							</p:selectOneMenu>

							<p:commandButton value="Angestellten hinzufügen" update="@form"
								actionListener="#{aufwandBean.saveKosten}" />
							<p:button id="neuerAngestellterButton"
								value="neuen Angestellten anlegen" icon="ui-icon-plus"
								outcome="angestellte_add.xhtml" type="button"
								title="neuer Kunde">
							</p:button>
						</p:fieldset>
						<p></p>
						<p:fieldset legend="Am Job arbeitende Angestellte">
							<ui:repeat var="kosten" value="#{aufwandBean.kostenFromJob}">
								<p:panel>
									<p:commandButton ajax="false"
										action="#{aufwandBean.delete(kosten)}" icon="ui-icon-trash"></p:commandButton>

									<p:commandButton ajax="false"
										action="#{aufwandBean.updateKosten(kosten)}"
										icon="ui-icon-disk"></p:commandButton>
									<p></p>
									<h:outputLabel value="Name: #{kosten.angestellte.vorname} "></h:outputLabel>
									<h:outputLabel value="#{kosten.angestellte.nachname}"></h:outputLabel>
									<h:panelGrid columns="3">
										<p:selectBooleanButton value="#{aufwandBean.aufwandInEuro}"
											offLabel="H" onLabel="€">
											<p:ajax listener="#{aufwandBean.rechneUm(kosten)}"
												process="aufwand_in_std aufwand_in_euro"
												update="aufwand_in_std aufwand_in_euro"></p:ajax>
										</p:selectBooleanButton>
										<p:panel id="aufwand_in_euro"
											visible="#{!aufwandBean.aufwandInEuro}">
											<p:inputText value="#{kosten.arbeitsaufwandInEuro}"></p:inputText>
											<p:outputLabel value="€"></p:outputLabel>
										</p:panel>
										<p:panel id="aufwand_in_std"
											visible="#{aufwandBean.aufwandInEuro}">
											<p:inputText value="#{kosten.arbeitsaufwandInStd}"></p:inputText>
											<p:outputLabel value="Stunden"></p:outputLabel>
										</p:panel>

									</h:panelGrid>
								</p:panel>

							</ui:repeat>
							<p:outputLabel value="Gesamtaufwand: #{aufwandBean.gesamtKosten}"></p:outputLabel>
						</p:fieldset>



					</h:panelGrid>

					<h:panelGrid columns="2">
						<p:button icon="ui-icon-alert" title="Achtung">
							<f:param name="achtung" />
						</p:button>
						<h:panelGrid columns="3">
							<p:outputLabel value="Budget" />
							<p:inputText value="#{jobticketBean.job.budgetInEuro}"
								read="only" />
							<p:button value="€" title="Aufwand Euro">
								<f:param name="aufwandEuroAsuagbe" />
							</p:button>
						</h:panelGrid>
					</h:panelGrid>
				</h:panelGrid>




				<p:button value="Fertig" outcome="start.xhtml"></p:button>
			</p:panel>


		</h:panelGrid>
	</h:form>
</h:body>
</html>